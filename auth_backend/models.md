ä»¥ä¸‹ã¯ã€ã‚ãªãŸã® Django ãƒ¢ãƒ‡ãƒ«ã«ãŠã‘ã‚‹å„ã‚¯ãƒ©ã‚¹é–“ã®é–¢ä¿‚æ€§ï¼ˆER å›³çš„è¦³ç‚¹ï¼‹ UML çš„è¦³ç‚¹ã®ä¸¡é¢ã‹ã‚‰ï¼‰ã‚’è©³ç´°ã«èª¬æ˜ã—ãŸã‚‚ã®ã§ã™ã€‚

---

### âœ… 1. `CustomUser` ã‚’ä¸­å¿ƒã¨ã—ãŸä¸»ãªé–¢ä¿‚æ€§

-   `CustomUser`ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¯ã€ä»–ã®å¤šãã®ãƒ¢ãƒ‡ãƒ«ã¨ **å¤–éƒ¨ã‚­ãƒ¼ï¼ˆOneToManyï¼‰** ã¾ãŸã¯ **å¤šå¯¾å¤šï¼ˆManyToManyï¼‰** é–¢ä¿‚ã‚’æŒã¡ã¾ã™ã€‚
-   ã“ã‚Œã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã™ã¹ã¦ã®æƒ…å ±ã®æ‰€æœ‰è€…/ä½œæˆè€…ã§ã‚ã‚‹ã€ã¨ã„ã†å‰æã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚

---

### âœ… 2. `Calendar` é–¢ä¿‚

-   **`Calendar.owner â†’ CustomUser`**
    â†’ å„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯ 1 äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ‰€æœ‰ã•ã‚Œã‚‹ï¼ˆ`ForeignKey`ï¼‰

-   **`Calendar.shared_users â†â†’ CustomUser`**
    â†’ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å…±æœ‰ã§ãã€å…±æœ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚è¤‡æ•°ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’æŒã¤ï¼ˆ`ManyToMany`ï¼‰
    â†’ ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ï¼š`CalendarShare`ï¼ˆ`can_edit` ãªã©ã®æ¨©é™ã‚’ç®¡ç†ï¼‰

-   **`CalendarEvent.calendar â†’ Calendar`**
    â†’ å„ã‚¤ãƒ™ãƒ³ãƒˆã¯ 1 ã¤ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å±ã™ã‚‹

---

### âœ… 3. `DiaryBook`ï¼ˆæ—¥è¨˜å¸³ï¼‰é–¢é€£

-   **`DiaryBook.owner â†’ CustomUser`**
    â†’ å„æ—¥è¨˜å¸³ã¯ 1 ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ‰€æœ‰ã•ã‚Œã‚‹

-   **`DiaryBook.shared_users â†â†’ CustomUser`**
    â†’ å¤šå¯¾å¤šï¼ˆ`DiaryBookShare` çµŒç”±ï¼‰

-   **`Entry.book â†’ DiaryBook`**
    â†’ å„ã‚¨ãƒ³ãƒˆãƒªã¯ 1 ã¤ã®æ—¥è¨˜å¸³ã«å±ã™ã‚‹

-   **`Entry.author â†’ CustomUser`**
    â†’ å„ã‚¨ãƒ³ãƒˆãƒªã«ã¯åŸ·ç­†è€…ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ãŒ 1 äººã„ã‚‹

-   **`Entry.shared_users â†â†’ CustomUser`**
    â†’ `EntryShare` ã«ã‚ˆã‚Šå…±æœ‰ã•ã‚Œã‚‹

-   **`EntryImages.entry â†’ Entry`**
    â†’ ã‚¨ãƒ³ãƒˆãƒªã«æ·»ä»˜ã•ã‚ŒãŸç”»åƒ

-   **`EntryImages.owner â†’ CustomUser`**
    â†’ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è€…ã¯ CustomUser

---

### âœ… 4. `ReminderGroup`ï¼ˆãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰

-   **`ReminderGroup.owner â†’ CustomUser`**
    â†’ å„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰€æœ‰

-   **`ReminderGroup.shared_users â†â†’ CustomUser`**
    â†’ ã‚°ãƒ«ãƒ¼ãƒ—ã¯è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å…±æœ‰ã§ãã‚‹ï¼ˆ`ReminderGroupShare` çµŒç”±ï¼‰

-   **`Reminder.group â†’ ReminderGroup`**
    â†’ å„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã¯ 1 ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹

-   **`Reminder.user â†’ CustomUser`**
    â†’ ä¸€è²«æ€§ã®ãŸã‚ã«å¸¸ã« `group.owner` ãŒè‡ªå‹•ã§è¨­å®šã•ã‚Œã‚‹

---

### âœ… 5. `Note` ãƒ¢ãƒ‡ãƒ«

-   **`Note.owner â†’ CustomUser`**
    â†’ å˜ç´”ãªãƒ¡ãƒ¢ã€‚æ‰€æœ‰è€…ï¼ˆä½œæˆè€…ï¼‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼

---

### ğŸ” ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã®è£œè¶³

| ä¸­é–“ãƒ¢ãƒ‡ãƒ«å         | èª¬æ˜                                                                     |
| -------------------- | ------------------------------------------------------------------------ |
| `CalendarShare`      | Calendar ã¨ CustomUser ã® ManyToMany ã‚’ç®¡ç†ã—ã€`can_edit` ç­‰ã®å±æ€§ã‚’ä¿æŒ |
| `DiaryBookShare`     | DiaryBook ã¨ CustomUser ã®ä¸­é–“ã€å…±æœ‰ã¨ç·¨é›†æ¨©é™ãªã©                       |
| `EntryShare`         | Entry ã¨ CustomUser ã®å…±æœ‰é–¢ä¿‚ã€`can_edit` ãƒ•ãƒ©ã‚°æœ‰ã‚Š                    |
| `ReminderGroupShare` | ReminderGroup ã¨ CustomUser ã®å…±æœ‰é–¢ä¿‚                                   |

---

### ğŸ” é–¢ä¿‚ã®è¦ç´„ï¼ˆç°¡ç•¥ï¼‰

```
CustomUser
â”‚
â”œâ”€â”€ owns â†’ Note
â”œâ”€â”€ owns â†’ Calendar â”€â”
â”‚                    â””â”€â”€ has â†’ CalendarEvent
â”œâ”€â”€ owns â†’ DiaryBook â”€â”
â”‚                     â””â”€â”€ has â†’ Entry â”€â”€â”€ has â†’ EntryImage
â”‚
â”œâ”€â”€ owns â†’ ReminderGroup â”€â”€â”€ has â†’ Reminder
â”‚
â”œâ”€â”€ shared in:
â”‚   â”œâ”€â”€ CalendarShare
â”‚   â”œâ”€â”€ DiaryBookShare
â”‚   â”œâ”€â”€ EntryShare
â”‚   â””â”€â”€ ReminderGroupShare
```

---

### âœ… çµè«–ã¨è¨­è¨ˆæ„å›³

-   `CustomUser` ã‚’ä¸­å¿ƒã«ã€å„ãƒªã‚½ãƒ¼ã‚¹ï¼ˆCalendar, Diary, Reminderï¼‰ã‚’ã€Œæ‰€æœ‰ã€ã‹ã¤ã€Œå…±æœ‰ã€ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã€æ‹¡å¼µæ€§ãƒ»æ¨©é™åˆ¶å¾¡ãŒå¯èƒ½ãªæ§‹æˆã€‚
-   ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨ã„ã¦ **å…±æœ‰** ï¼‹ **æ¨©é™ï¼ˆcan_editï¼‰** ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã—ã¦ã„ã‚‹ç‚¹ã¯è¨­è¨ˆã¨ã—ã¦éå¸¸ã«å …ç‰¢ã§ã™ã€‚

---

ã“ã®é–¢ä¿‚æ€§ã‚’åŸºã«ã€ãƒ“ãƒ¥ãƒ¼å±¤ã§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚„èªå¯è¨­è¨ˆï¼ˆIsOwnerã€IsSharedUser ãªã©ï¼‰ã‚‚è‡ªç„¶ã«å®Ÿè£…ã§ãã¾ã™ã€‚å¿…è¦ã§ã‚ã‚Œã°ãã®è¨­è¨ˆæŒ‡é‡ã‚‚ãŠå‡ºã—ã§ãã¾ã™ã€‚
